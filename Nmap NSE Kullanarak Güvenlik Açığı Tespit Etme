Nmap NSE Kullanarak Güvenlik Açığı Tespit Etme
Nmap NSE, Nmap'in sunduğu geniş script kütüphanesini kullanarak hedef sistemler hakkında derinlemesine bir analiz yapmaya ve güvenlik açıklarını keşfetmeye yarayan bir araçtır. Nmap NSE ile birçok farklı senaryo çalıştırabilir ve hedef sistemlerin ağ özelliklerini, açık portlarını, çalışan servislerini, işletim sistemlerini ve zafiyetlerini tespit edebilirsiniz.
Nmap NSE kullanarak güvenlik açıklarını tespit etmek için aşağıdaki adımları takip edin:
1. Adım: Nmap Script Engine (NSE) kullanarak FTP hizmetinin Anonymous kullanıcısının parolası boş ise bunu tespit edelim.
Bu adımda, hedef sistemin 21 numaralı portunda çalışan FTP servisinin, Anonymous kullanıcısına izin verip vermediğini kontrol etmek için ftp-anon.nse isimli script'i kullanıyoruz. Bu script, FTP servisine Anonymous kullanıcısı ile bağlanmayı deneyerek, bu kullanıcının erişim iznini ve erişebildiği dizinleri tespit eder. Bu script'i çalıştırmak için şu komutu kullanabilirsiniz:
root@bt:/usr/local/share/nmap/scripts# nmap 10.10.15.12 -p 21 --script=ftp-anon -PN -n
Bu komutta, -p 21 parametresi ile sadece 21 numaralı portu tarıyoruz, --script=ftp-anon parametresi ile ftp-anon.nse script'ini çalıştırıyoruz, -PN parametresi ile hedef sisteme ping göndermeden tarama yapıyoruz ve -n parametresi ile DNS çözümlemesi yapmadan IP adresi ile tarama yapıyoruz. Tüm NSE script'lerini görmek için /usr/local/share/nmap/scripts dizinine bakabilirsiniz.
2. Adım: NSE kullanarak belli bir IP aralığındaki MS08-067 açıklığı ve Conficker virüsüne sahip sunucuları bulalım. Bu taramayı smb-check-vulns.nse isimli script ile yapalım.
Bu adımda, hedef sistemlerin 139 ve 445 numaralı portlarında çalışan SMB servislerinin, MS08-067 açıklığı ve Conficker virüsüne sahip olup olmadığını kontrol etmek için smb-check-vulns.nse isimli script'i kullanıyoruz. Bu script, SMB servislerinin versiyon bilgilerini, güvenlik modlarını, işletim sistemlerini ve zafiyet durumlarını tespit eder. Bu script'i çalıştırmak için şu komutu kullanabilirsiniz:
root@bt:~# nmap 6.6.6.90-99 --script=smb-check-vulns -PN -p 139,445 -n
Bu komutta, 6.6.6.90-99 parametresi ile verilen IP aralığını tarıyoruz, --script=smb-check-vulns parametresi ile smb-check-vulns.nse script'ini çalıştırıyoruz, -PN parametresi ile hedef sistemlere ping göndermeden tarama yapıyoruz, -p 139,445 parametresi ile sadece 139 ve 445 numaralı portları tarıyoruz ve -n parametresi ile DNS çözümlemesi yapmadan IP adresi ile tarama yapıyoruz.