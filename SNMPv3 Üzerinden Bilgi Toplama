SNMPv3 Üzerinden Bilgi Toplama
SNMPv3, SNMP protokolünün en güncel ve güvenli sürümüdür. SNMPv3, şifreleme ve kimlik doğrulama gibi güvenlik özellikleri sunar. SNMPv3 ile bilgi toplamak için, hedef sistemde SNMPv3 servisinin çalıştığını ve kullanıcı adı ve parola gibi kimlik bilgilerini bilmek gerekir. Bu bilgileri elde etmek için, SNMPv3 User Enumerator and Attack tool gibi araçlar kullanılabilir. Bu araç, hedef sistemdeki SNMPv3 kullanıcılarını ve parolalarını brute force yöntemiyle tespit etmeye çalışır.
SNMPv3 kullanıcı ve parola bilgilerini elde ettikten sonra, SNMPv3 ile bilgi toplamak için aşağıdaki adımları izleyebilirsiniz:
1. Adım: Hedef sistemde SNMPv3 servisinin çalışıp çalışmadığını ve hangi versiyonunu kullandığını nmap ile taramak. Bu işlem için, nmap'in snmp-info scriptini kullanabilirsiniz. Örneğin, hedef IP 192.168.5.9 ise, aşağıdaki komutu kullanabilirsiniz:
nmap -sU -p 161 --script snmp-info 192.168.5.9
Bu komut, hedef sistemde SNMPv3 servisinin çalışıp çalışmadığını, hangi versiyonunu kullandığını, hangi portu dinlediğini, hangi community stringleri desteklediğini ve sistem hakkında bazı temel bilgileri verir.
2. Adım: SNMPv3 ile hedef sistem hakkında daha fazla bilgi toplamak için, snmpwalk veya snmp-check gibi araçlar kullanabilirsiniz. Bu araçlar, SNMPv3 protokolü ile hedef sistemdeki farklı OID'leri (Object Identifier) sorgular ve bunlara karşılık gelen değerleri döndürür. OID'ler, SNMP yönetilen cihazlardaki farklı nesneleri tanımlayan sayısal dizilerdir. Örneğin, sistem adı, sistem açıklaması, sistem zamanı, arayüz bilgileri, işlemci yükü, bellek kullanımı, disk alanı, çalışan süreçler, yüklü yazılımlar, vb. gibi bilgileri elde etmek için farklı OID'ler kullanılabilir. Bu bilgiler, hedef sistemin zayıf noktalarını veya saldırı vektörlerini belirlemek için kullanılabilir.
snmpwalk aracını kullanmak için, aşağıdaki komutu kullanabilirsiniz:
snmpwalk -v 3 -u <username> -l <security level> -a <authentication protocol> -A <authentication password> -x <encryption protocol> -X <encryption password> <target IP>
Bu komut, hedef sistemdeki tüm OID'leri sorgular ve bunlara karşılık gelen değerleri ekrana yazdırır. Bu işlem uzun sürebilir ve çok fazla çıktı üretebilir. Bu yüzden, belirli bir OID'yi veya OID grubunu sorgulamak isterseniz, komutun sonuna ekleyebilirsiniz. Örneğin, hedef sistemdeki sistem adını ve sistem açıklamasını sorgulamak için, aşağıdaki komutu kullanabilirsiniz:
snmpwalk -v 3 -u <username> -l <security level> -a <authentication protocol> -A <authentication password> -x <encryption protocol> -X <encryption password> <target IP> 1.3.6.1.2.1.1.5 1.3.6.1.2.1.1.1
snmp-check aracını kullanmak için, aşağıdaki komutu kullanabilirsiniz:
snmp-check -t <target IP> -v 3 -u <username> -l <security level> -a <authentication protocol> -A <authentication password> -x <encryption protocol> -X <encryption password>
Bu komut, hedef sistem hakkında genel bir rapor oluşturur. Bu rapor, sistem adı, sistem açıklaması, sistem zamanı, arayüz bilgileri, işlemci yükü, bellek kullanımı, disk alanı, çalışan süreçler, yüklü yazılımlar, vb. gibi bilgileri içerir.
3. Adım: SNMPv3 ile hedef sistemdeki belirli bilgileri veya dosyaları okumak veya değiştirmek için, snmpset veya snmpget gibi araçlar kullanabilirsiniz. Bu araçlar, SNMPv3 protokolü ile hedef sistemdeki belirli OID'leri okumak veya yazmak için kullanılabilir. Örneğin, hedef sistemdeki sistem adını değiştirmek için, aşağıdaki komutu kullanabilirsiniz:
snmpset -v 3 -u <username> -l <security level> -a <authentication protocol> -A <authentication password> -x <encryption protocol> -X <encryption password> <target IP> 1.3.6.1.2.1.1.5.0 s <new system name>
Bu komut, hedef sistemdeki sistem adını belirtilen yeni sistem adı ile değiştirir. Bu işlem, hedef sistemdeki SNMPv3 servisinin yazma yetkisine sahip olmanızı gerektirir. Aksi takdirde, işlem başarısız olur.